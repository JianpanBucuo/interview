## mysql count() 函数

- count() 函数用来统计结果集中不为 null 的数据个数
- 首先存储引擎查询出结果集
- server 层逐个结果判断是否为 null， 不为 null 则加 1

count 用来计算行数

## count 非索引字段

- count（非索引字段）时，server 层需要判断每个数据是否为 null
- 需要再走聚簇索引，把每一行的数据拿出来，再判断是否为 null
- 而且查询本身无法使用覆盖索引，理论上最慢

先查询 -> 取出数据 -> 判空

## count 索引字段

- count（索引字段）时，可以覆盖，依然需要每次判断字段是否为 null

## count 主键

- 还是需要判断是否为 null

## count(1)

会自动选择一个索引，送到 server 层

- server 层还是要判断 1 是否为 null

## count(\*)

- 应该所有字段不为 1 才加 一
  但是
  MYISAM 的 count(\*) 直接返回数据库中记录的数据表行数
- innodb 支持事务，数据库中不记录数据库行数
- mysql 专门优化了 count(\*)函数直接返回索引树中数据的个数 （挑一个最优的 B+树遍历）

## 总结

- count 非索引字段

聚簇查询 -> 取出数据 ->送到 server 层-> 判空

- count 索引字段

覆盖查询 -> 送到 server 层 -> 判空

- count(1)
  挑选最优的索引查询 ->送到 server 层 -> 1 !== 判空

- count(\*)
  挑选最优的索引查询 -> 送到 sever 层 -> 不需要判断返回 B+树的数据量
